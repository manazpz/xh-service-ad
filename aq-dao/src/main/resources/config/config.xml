<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="aq.dao.config.ConfigDao">

    <!--插入配置表-->
    <insert id="insertConfig" >
        INSERT INTO system_config
        VALUES(#{id},#{name},#{keyWord},#{num},#{type},#{flag})
    </insert>

    <!--更新配置表-->
    <update id="updateConfig" parameterType="java.util.Map">
        UPDATE system_config sc
        <trim prefix="set" suffixOverrides=",">
            <if test="name!=null">
                sc.NAME = #{name},
            </if>
            <if test="keyWord!=null">
                sc.KEY_WORD = #{keyWord}
            </if>
            <if test="num!=null">
                sc.NUM = #{num}
            </if>
            <if test="type!=null">
                sc.TYPE = #{type}
            </if>
            <if test="flag!=null">
                sc.FLAG = #{flag}
            </if>
        </trim>
        WHERE sc.ID = #{id}
    </update>

    <!--删除配置表-->
    <delete id="deleteConfig"  parameterType="java.util.Map" >
        DELETE FROM system_config WHERE ID = #{id}
    </delete>

    <!--查询配置表-->
    <select id="selectConfig" resultType="java.util.Map" parameterType="java.util.Map">
        SELECT
          sc.ID AS id,
          sc.NAME AS name,
          sc.KEY_WORD AS keyWord,
          sc.NUM AS num,
          sc.TYPE AS type,
          sc.FLAG AS flag
        FROM system_config sc
        WHERE 1=1
        <if test="name != null">
            AND sc.NAME = #{name}
        </if>
        <if test="id != null">
            AND sc.ID = #{id}
        </if>
        <if test="type != null">
            AND sc.TYPE in (${type})
        </if>
        <if test="flag != null">
            AND sc.FLAG = ${flag}
        </if>
        <if test="keyWord != null">
            AND sc.KEY_WORD = #{keyWord}
        </if>
    </select>

    <!--查询第三方配置表-->
    <select id="selectTppConfig" resultType="java.util.Map" parameterType="java.util.Map">
        SELECT
        stc.ID AS id,
        stc.NAME AS name,
        stc.PLATFORM AS platform,
        stc.ACCESS_KEY_ID AS accessKeyId,
        stc.ACCESS_KEY_SECRET AS accessKeySecret,
        stc.ENDPOINT AS endpoint,
        stc.BACKET_NAME AS backetName,
        stc.ACCESS_TOKEN AS accessToken,
        DATE_FORMAT(
        stc.UPDATE_TIME,
        '%Y-%m-%d %H:%i:%S'
        ) AS updateTime,
        stc.RETURN_URL AS returnUrl
        FROM system_tpp_config stc
        WHERE 1=1
        <if test="platform != null">
            AND stc.PLATFORM = #{platform}
        </if>
        <if test="id != null">
            AND stc.ID = #{id}
        </if>
    </select>

    <!--更新配置表-->
    <update id="updateTppConfig" parameterType="java.util.Map">
        UPDATE system_tpp_config sc
        <trim prefix="set" suffixOverrides=",">
            <if test="access_token!=null">
                sa.ACCESS_TOKEN = #{access_token},
            </if>
            <if test="update_time!=null">
                sc.UPDATE_TIME= #{update_time}
            </if>

        </trim>
        WHERE sc.ID = #{id}
    </update>

</mapper>