webpackJsonp([12],{mVOC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),n=i.n(s),a={name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleReize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleReize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},reset:function(){this.active&&(this.position="",this.width="auto",this.active=!1,this.isSticky=!1)},handleScroll:function(){this.width=this.$el.getBoundingClientRect().width,this.$el.getBoundingClientRect().top<this.stickyTop?this.sticky():this.reset()},handleReize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:{height:t.height+"px",zIndex:t.zIndex}},[i("div",{class:t.className,style:{top:t.stickyTop+"px",zIndex:t.zIndex,position:t.position,width:t.width,height:t.height+"px"}},[t._t("default",[i("div",[t._v("sticky")])])],2)])},staticRenderFns:[]},c=i("VU/8")(a,o,!1,null,null,null).exports,l=i("vMJZ"),d=i("cAgV"),r=i("IcnI"),h={name:"assignPermissions",directives:{waves:d.a},components:{Sticky:c},data:function(){return{status:"published",tableKey:0,list:null,listLoading:!0,loading:!1,isAm:!1,checkedCities:[]}},watch:{$route:function(t,e){"/user/assignPermissions"===t.path&&this.getList()}},created:function(){this.getList()},methods:{setLocalStorage:function(){window.localStorage.setItem("user",n()(this.$route.params.id))},getList:function(){var t=this,e=null;this.$route.params.id?(e=this.$route.params.id,this.setLocalStorage()):e=JSON.parse(window.localStorage.getItem("user")),e?(this.listLoading=!0,Object(l.n)(e).then(function(e){if(50001===e.code&&r.a.dispatch("GetRefreshToken").then(function(){t.getList()}),200===e.code){t.list=e.data.items,t.checkedCities=e.data.checkedCities,t.isAm=!1;for(var i=0;i<=t.list.length;i++){if("AM"===t.list[i].key){for(var s=0;s<=t.checkedCities.length;s++){if(t.checkedCities[s]===t.list[i].desc[0].id){t.isAm=!0;break}}break}}setTimeout(function(){t.listLoading=!1},1500)}}).catch(function(){t.listLoading=!1})):this.listLoading=!1},handleCheckAllChange:function(t){"AM"===t&&(this.isAm=!this.isAm)},submitForm:function(){var t=this;this.loading=!0;var e={userId:JSON.parse(window.localStorage.getItem("user")),permissions:this.checkedCities};Object(l.a)(e).then(function(e){50001===e.code&&r.a.dispatch("GetRefreshToken").then(function(){t.submitForm()}),200===e.code&&(t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),t.loading=!1)}).catch(function(){t.loading=!1})}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("sticky",{attrs:{className:"sub-navbar "+t.status}},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("发布\n    ")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%",height:"100%","margin-top":"20px"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":"","header-cell-style":{background:"#c0c0c0"}}},[i("el-table-column",{attrs:{align:"center",label:t.$t("permission.module"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:t.$t("permission.depict"),"min-width":"1000"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-checkbox-group",{model:{value:t.checkedCities,callback:function(e){t.checkedCities=e},expression:"checkedCities"}},t._l(e.row.desc,function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.id,disabled:"AM"!=e.moduleKey&&t.isAm},on:{change:function(i){t.handleCheckAllChange(e.moduleKey)}}},[t._v(t._s(e.name))])}))]}}])})],1)],1)},staticRenderFns:[]},g=i("VU/8")(h,u,!1,null,null,null);e.default=g.exports},mvHQ:function(t,e,i){t.exports={default:i("qkKv"),__esModule:!0}},qkKv:function(t,e,i){var s=i("FeBl"),n=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}}});